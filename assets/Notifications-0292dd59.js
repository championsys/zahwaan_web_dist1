import{U as R,A as F,p as $,a9 as I,u as J,s as k,o as Y,r as w,a as c,c as l,b as s,F as S,j as b,n as _,l as N,k as z,x as L,d as y,t as g,J as T,$ as V}from"./index-e698aeb1.js";R();const j=F({id:"notification",state:()=>({notifications:[]}),getters:{getNotifications:u=>u.notifications},actions:{async loadNotifications(u){const e=$();return e.btnLoadingStart(),await this.$http.post("/snd_ecommerce.notification.get_notifications",u).then(f=>{if(e.btnLoadingFinish(),f.status===200)return this.notifications=f.data.data,!0}).catch(f=>{throw e.btnLoadingFinish(),f})},async markNotificationAsRead(){return await this.$http.get("/snd_ecommerce.notification.mark_notification_as_read").then(u=>{if(u.status===200)return!0}).catch(u=>{throw u})}}}),E={class:"notifications"},P={class:"notifications-conent"},U={class:"notifications-conent-list-title"},q={class:"notifications-conent-list-item-icon"},G={key:0,class:"notifications-conent-list-item-title"},H={class:"notifications-conent-list-item-text"},K={class:"notifications-conent-list-item-date"},Q={key:0},W={key:2,class:"search-no-data",style:{border:"none"}},X={class:"search-no-data-content"},Z={class:"search-no-data-content-title"},x={class:"search-no-data-content-subtitle"},et={__name:"Notifications",setup(u){const e=j(),f=I();J();const r=k([]),m=k(!0),C=$(),{cookies:O}=R(),A=O.get("zahwaanLoginData",{parseJSON:!0}),D=i=>{var o=new Date(i);return o.setMinutes(o.getMinutes()-o.getTimezoneOffset()),o.toJSON().slice(0,10)},p=k({page:1,page_length:10}),B=i=>{p.value.page=p.value.page+1,e.loadNotifications(p.value).then(()=>{const o=e.getNotifications.content.reduce((t,n)=>{const a=D(n.date);return t[a]||(t[a]=[]),t[a].push(n),t},{});Object.keys(o).forEach(t=>{r.value[t]?r.value[t]=[...r.value[t],...o[t]]:r.value[t]=o[t]}),e.getNotifications.content.filter(t=>t.is_read=!0)[0]&&setTimeout(()=>{e.markNotificationAsRead()},5e3)})};return Y(()=>{e.loadNotifications(p.value).then(()=>{var i,o;if(m.value=!0,e.getNotifications&&((o=(i=e.getNotifications)==null?void 0:i.content)==null?void 0:o.length)>0){const v=e.getNotifications.content.reduce((n,a)=>{const d=D(a.date);return n[d]||(n[d]=[]),n[d].push(a),n},{});r.value=v,e.getNotifications.content.filter(n=>n.is_read=!0)[0]&&setTimeout(()=>{e.markNotificationAsRead()},5e3)}m.value=!1,A&&f.loadUserInfo()})}),(i,o)=>{var n;const v=w("business-account-2-icon"),t=w("no-data-icon");return c(),l("main",E,[s("div",P,[!m.value&&(r.value||r.value.length>0)?(c(!0),l(S,{key:0},b(r.value,(a,d)=>(c(),l("div",{class:"notifications-conent-list",key:d},[s("p",U,g(i.formatDaysDate(d,"YYYY/MM/DD")),1),(c(!0),l(S,null,b(a,(h,M)=>(c(),l("div",{key:M,class:L(["notifications-conent-list-item",h.is_read==0?"not-read":""])},[s("div",null,[s("div",q,[y(v)])]),s("div",null,[h.title?(c(),l("h2",G,g(h.title),1)):_("",!0),s("p",H,g(h.content),1)]),s("div",K,[s("p",null,g(i.formatDate(h.date)),1),h.is_read==0?(c(),l("label",Q)):_("",!0)])],2))),128))]))),128)):_("",!0),p.value.page<((n=N(e).getNotifications)==null?void 0:n.last_page)?(c(),z(N(T),{key:1,title:i.$t("common.Show more"),type:"button",prependIcon:"arrow-left-icon",class:L(N(C).getBtnLoading?"suggested-products-content-btn is-loading":"suggested-products-content-btn"),onOnClick:o[0]||(o[0]=a=>B())},null,8,["title","class"])):_("",!0),!m.value&&r.value.length<1?(c(),l("div",W,[s("div",X,[y(t,{class:"search-no-data-content-icon"}),s("h1",Z,g(i.$t("common.Sorry, there are no notifications")),1),s("p",x,g(i.$t("common.do not notifications yet")),1)])])):_("",!0),m.value?(c(),l(S,{key:3},b(5,(a,d)=>s("div",{class:"notifications-conent-list-item-shimmers",key:d},[y(N(V),{"is-loading":!0})])),64)):_("",!0)])])}}};export{et as default};
